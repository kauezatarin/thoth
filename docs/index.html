<!DOCTYPE html>
<html>
<head>
  <title>Godot Save/Load Game State</title>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/prismjs@1.20.0/themes/prism.min.css" />
  <script src="https://cdn.jsdelivr.net/npm/prismjs@1.20.0/prism.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/prismjs@1.20.0/components/prism-gdscript.min.js"></script>
  <style>
    body {
      text-align: center;
      overflow: auto;
      background-color: #286b40;
      font-family: Helvetica;
      font-size: 16px;
      line-height: 25px;
    }

    .scroll-region {
      display: inline-block;
      width: 70%;
      max-width: 1000px;
      padding: 50px 20px 100px 20px;
      text-align: left;
      background-color: #a3cfb3;
    }

    pre[class*="language-"]{
    }

    pre[class*="language-"],
    code[class*="language-"]{
        background-color: #071f0f;
        text-shadow: none;
        color: #a3cfb3;
        margin: 0;
    }

    .token.operator {
        background: none;
    }

    hr {
        height: 3px;
        border: 0;
        background-color: #286b40;
    }

    h1 {
      font-size: 30px;
    }

    h2 {
      font-size: 22px;
    }
  </style>
</head>
<body>
  <div class="scroll-region">
    <h1 style="font-size:55px;text-align:center;">Godot Save/Load Game State</h1>

    <h1>Index</h1>
    <a href="#explained"><h2>Explanation</h2></a>
    <a href="#tutorial"><h2>Tutorial</h2></a>
    <a href="#methods"><h2>Method descriptions</h2></a>
    <a href="#format"><h2>File format</h2></a>
    <hr>

    <h1 id="explained">Explanation</h1>
    <hr>

    <h1 id="tutorial">Tutorial</h1>
    <p>Spoj de ureche!</p>
    <pre><code class="language-gdscript">func _on_config_load_pressed():
	$ConfigState.load_game_state()
	$ConfigState.get_game_variables(self)
	$a.value = a
	$b.value = b
	$c.value = c

func _on_config_save_pressed():
	a = $a.value
	b = $b.value
	c = $c.value
	$ConfigState.load_game_state()
	$ConfigState.set_game_variables(self)
	$ConfigState.save_game_state()
</code></pre>

    <hr>

    <h1 id="methods">Method descriptions</h1>
    <hr>

    <h2>visited_level(level)</h2>
    <p>Returns a boolean indicating whether a level has been visited.</p>
    <p><strong>Input:</strong> level - the level object to check</p>
    <p><strong>Output:</strong> Boolean</p>
    <hr>

    <h2>clear_level_history(level_filename)</h2>
    <p>Removes the given level history from the current game state.</p>
    <p><strong>Input:</strong> String - the level filename</p>
    <hr>

    <h2>save_exists()</h2>
    <p>Returns a boolean indicating whether a save file exists.</p>
    <p><strong>Output:</strong> A boolean indicating whether the save file exists</p>
    <hr>

    <h2>pack_game_state(level)</h2>
    <p>Adds the given level to the current game state. It does this by serializing the level, adding all the variables registered in "serializable" and/or collections registered in "serializable_collections".</p>
    <p><strong>Input:</strong> level - the level object to add to the game state</p>
    <hr>

    <h2>unpack_game_state(level)</h2>
    <p>Restores the state of the given level from the current game state. The variables in this object will be overwritten and collections will be repopulated.</p>
    <p><strong>Input:</strong> level - the level object to restore the state for</p>
    <hr>

    <h2>set_game_variables(node)</h2>
    <p>Adds variables of the given node to the current game state.</p>
    <p><strong>Input:</strong> node - the node whose variables to save to the game state</p>
    <hr>

    <h2>get_game_variables(node)</h2>
    <p>Restores the variables of the given node from the current game state.</p>
    <p><strong>Input:</strong> node - the node whose variables to restore from the game state</p>
    <hr>

    <h2>load_game_state(game_version = "default")</h2>
    <p>Loads the game state from a save file. This will overwrite the current game state, this means that any packing done before calling this function will be lost, packing should be done after a load to append new map data to a save. Optionally a version of the game can be provided, by default the game version is "default". This is useful if the object format has changed for the game and not compatible with older versions</p>
    <p><strong>Input:</strong> game_version - the version of the game state to load (optional, default value is "default")</p>
    <hr>

    <h2>save_game_state(game_version = "default")</h2>
    <p>Saves the current game state to a save file.</p>
    <p><strong>Input:</strong> game_version - the version of the game state to save (optional, default value is "default")</p>

    <h1 id="format">File format</h1>
    <p>The code provided saves and loads game state data in a specific format defined in a JSON-like file.The game state data is stored in a dictionary-like structure with the top level key being a version name string "$version_name". Each version name points to a dictionary containing two keys, "variables" and "maps".The "variables" key holds information about game-wide variables and their values.The "maps" key is also a dictionary that holds information about saved map state data. Each key within the "maps" dictionary is a string representing the file name of the map in the format of "$map_file_name.tscn". The value of each key is another dictionary that holds information about the saved state of the map.This map dictionary has two keys, "collections" and "objects". The "collections" key holds information about the state of various object collections in the map. The "objects" key holds information about individual objects within the map.Each object in the "collections" or "objects" keys is represented by a dictionary with several keys. The "type" key is a string indicating the type of object being saved. The "name" key holds the name of the object as a string. The "filename" key holds the file name of the object as a string. The "position", "scale", and "rotation" keys hold information about the object's position, scale, and rotation respectively. The "variables" key holds a dictionary of object-specific variables and their values.Each variable within the "variables" key of an object is also represented by a dictionary with a "type" key indicating the type of the variable and other keys holding the value of the variable. The supported types of variables include "object_reference", "vector2", "vector3", "array", and "object".</p>
    <hr>
  </div>
</body>
</html>
